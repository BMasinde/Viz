---
title: "Visualization Lab 2"
author: "Roshni Sundaramurthy (rossu809); Brian Masinde (brima748)"
date: "17 September 2018"
output:
  html_notebook:
    theme: journal
  html_document:
    df_print: paged
fontsize: 11pt
---

### Assignment 1. Perception Visualization

```{r data}
olive <- read.csv("olive.csv", sep = ",", header = TRUE)
```

```{r libraries, message=FALSE, warning=FALSE, paged.print=FALSE}
library(ggplot2)
library(plotly)
library(MASS)
```

```{r question1_a}
p_vs_o <- ggplot(olive, aes(x=oleic, y=palmitic,
                     color = linolenic)) +
  geom_point() 
  #xlab("")
p_vs_o
```

```{r cut_interval}
olive$linolenic2 <- cut_interval(olive$linolenic, n=4)
```


```{r question1_b}
p_vs_o2 <- ggplot(olive, aes(x=oleic, y=palmitic, color = linolenic2)) + 
  geom_point()

p_vs_o2
```

```{r question 2, warning=FALSE}
p_vs_o3 <- ggplot(olive, aes(palmitic, oleic)) +
  geom_point(aes(color=linolenic2, size=linolenic2)) +
  geom_spoke(aes(angle=as.numeric(linolenic2),radius=as.numeric(linolenic2)))

p_vs_o3
```

```{r Question3}
o_vs_e <- ggplot(olive, aes(x=oleic, y=eicosenoic, color = Region)) + 
  geom_point()
o_vs_e
```

```{r question3_b}
o_vs_e0 <- ggplot(olive, aes(x=oleic, y = eicosenoic, color = as.factor(Region)))+
  geom_point()

o_vs_e0
```


```{r discretization}
olive$linoleic2 <- cut_interval(olive$linoleic, n=3)
olive$palmitic2 <- cut_interval(olive$palmitic, n=3)
olive$palmitoleic2 <- cut_interval(olive$palmitoleic, n=3)
```

```{r question4, warning=FALSE}
o_vs_e1 <- ggplot(olive, aes(x=oleic, y=eicosenoic)) + 
  geom_point(aes(color=linoleic2, size=palmitoleic2, shape=palmitic2))
o_vs_e1
```

```{r question5, warning=FALSE}
o_vs_e2 <- ggplot(olive, aes(x=oleic, y=eicosenoic)) + 
  geom_point(aes(color=Region, size=palmitoleic2, shape=palmitic2))

o_vs_e2
```

```{r question6}
plot_ly(data = olive, labels=~Area, type = 'pie', showlegend = F) %>%
  layout(title = 'Proportion of Oils from different regions',
        xaxis = list(showgrid = F, zeroline = F, showticklables = F),
         yaxis = list(showgrid = F, zeroline = F, showticklables = F))

```

```{r question7}
l_vs_e <- ggplot(olive, aes(x = linoleic, y = eicosenoic)) +
  geom_point() + 
  geom_density_2d()#+
  #stat_density_2d(aes(fill = stat(level)), geom = "polygon")
l_vs_e  
```

### Assignment 2: Multidimensional Scaling of a high-dimensional object

```{r}
# reading the data
baseball <- read.csv("baseball-2016.csv", sep = ",", header = TRUE)
```

#### Question1
The xlsx file is converted to a csv file, makes it easier to load the data without extra packages. It is reasonable to scale the data because they have different ranges so that features with large scales do not dominate. Example, comparing maximum value and minimum value for "AB" and "Home runs per game". The two are on totally different scales.

```{r}
# summary of AB
summary(baseball$AB)
```

```{r}
#summary of HR
summary(baseball$HR.per.game)
```

#### Question 2

```{r}
# scale the 26 numeric columns
baseball2 <- scale(baseball[ ,3:ncol(baseball)])
```

```{r}
# Getting distance between points using Minkowski
mink_d <- dist(baseball2, method = "minkowski", p =2)
```

```{r message=FALSE, warning=FALSE, paged.print=FALSE}
# get 2 column vector with fitted configuration 
resid <- isoMDS(mink_d, k=2 )

# getting the coordinates
coords <- resid$points

# convert coords to dataframe
coordsMDS <- as.data.frame(coords)

# cbind to get column Team and League
coordsMDS2 <- cbind(baseball[ , 1:2], coordsMDS)
```

```{r message=FALSE, warning=FALSE, paged.print=FALSE}
# plot the new dimension and color by  League
plot_ly(coordsMDS2, x= ~V1, y = ~V2, type ="scatter", hovertext = ~ Team,
            color = ~League, colors = c("#0444BF","#F46A4E"))
```

```{r}
# get MDS variable V2 and cbind with points from isoMDS
d4 <- cbind(baseball[ ,1:2], coords[,2], baseball2[,])

# rename col3 to V2
colnames(d4)[3] <- c("V2")
```



